<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>–ó–∞ –º–æ–µ—Ç–æ –°–ª—ä–Ω—Ü–µ ‚ù§Ô∏è</title>
<style>
    :root { --p: #ff0080; --s: #ff66cc; --gold: #ffd700; }
    
    body, html { 
        margin: 0; padding: 0; width: 100%; height: 100dvh; 
        overflow: hidden; background: #000; 
        font-family: -apple-system, system-ui, sans-serif;
        touch-action: none; transition: background 3s ease-in-out;
    }

    /* –°–ª–æ–µ–≤–µ –∑–∞ –µ—Ñ–µ–∫—Ç–∏ */
    #bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; transition: 3s; opacity: 0.5; }
    .particle { position: absolute; pointer-events: none; z-index: 50; will-change: transform, opacity; }

    /* –¢–µ–∫—Å—Ç –∑–∞ –Ω–∞—Å–æ–∫–∏ */
    #instruction {
        position: absolute; top: 12%; width: 100%; text-align: center;
        color: white; font-size: 18px; font-weight: 300; letter-spacing: 3px;
        z-index: 100; text-shadow: 0 0 15px var(--p);
        transition: opacity 1s, transform 1s;
    }

    /* –û–±–µ–∫—Ç–∏ */
    .game-obj {
        position: absolute; transform: translate(-50%, -50%) scale(0);
        cursor: pointer; border: none; background: none;
        -webkit-tap-highlight-color: transparent; transition: transform 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 1s;
        z-index: 150;
    }

    #mainHeart { top: 45%; left: 50%; font-size: 100px; display: block; transform: translate(-50%, -50%) scale(1); }
    .active-heart { animation: beat 2s infinite ease-in-out; }

    .teddy { bottom: -150px; font-size: 90px; }
    #flower-garden { position: absolute; width: 100%; height: 100%; display: none; }

    /* –§–∏–Ω–∞–ª–µ–Ω —Ç–µ–∫—Å—Ç */
    #finalContainer {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
        width: 100%; text-align: center; z-index: 200; transition: 2s cubic-bezier(0.19, 1, 0.22, 1);
    }
    #finalMsg {
        font-size: 40px; font-weight: 900;
        background: linear-gradient(90deg, #fff, var(--gold), var(--p), #fff);
        background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        animation: shine 4s linear infinite;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes beat { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.1); } }
    @keyframes shine { to { background-position: 200% center; } }
    @keyframes floatAround { 0%, 100% { transform: translate(0,0); } 50% { transform: translate(10px, -20px); } }

</style>
</head>
<body>

<div id="bg-overlay"></div>
<div id="instruction">–î–µ–Ω–∏—Ü–∞... –¥–æ–∫–æ—Å–Ω–∏ —Å—ä—Ä—Ü–µ—Ç–æ, –∑–∞ –¥–∞ –∑–∞–ø–æ—á–Ω–µ –º–∞–≥–∏—è—Ç–∞ ‚ú®</div>

<button id="mainHeart" class="game-obj active-heart">‚ù§Ô∏è</button>
<button id="teddyL" class="game-obj teddy" style="left: 25%;">üß∏</button>
<button id="teddyR" class="game-obj teddy" style="left: 75%;">üß∏</button>
<div id="flower-garden"></div>

<div id="finalContainer">
    <div id="finalMsg">–û–ë–ò–ß–ê–ú –¢–ï, –°–õ–™–ù–¶–ï! üíñ</div>
</div>

<script>
    const instr = document.getElementById('instruction');
    const heart = document.getElementById('mainHeart');
    const teddyL = document.getElementById('teddyL');
    const teddyR = document.getElementById('teddyR');
    const garden = document.getElementById('flower-garden');
    const finalCont = document.getElementById('finalContainer');
    const bg = document.getElementById('bg-overlay');

    let flowerCount = 0;

    // --- –°–¶–ï–ù–ê 1: –°–™–†–¶–ï–¢–û ---
    heart.onclick = () => {
        heart.classList.remove('active-heart');
        heart.style.transform = 'translate(-50%, -50%) scale(0) rotate(360deg)';
        slowExplosion(window.innerWidth/2, window.innerHeight/2, 'üíñ', 20);
        
        setTimeout(() => {
            heart.style.display = 'none';
            instr.style.opacity = '0';
            setTimeout(() => {
                instr.innerText = '–ú–µ—á–µ—Ç–∞—Ç–∞ —Ç–µ —á–∞–∫–∞—Ç... –ø—Ä–µ–≥—ä—Ä–Ω–∏ –µ–¥–Ω–æ –æ—Ç —Ç—è—Ö';
                instr.style.opacity = '1';
                bg.style.background = 'radial-gradient(circle, #330033, #000)';
                teddyL.style.transform = 'translate(-50%, -50%) scale(1)';
                teddyR.style.transform = 'translate(-50%, -50%) scale(1)';
                teddyL.style.bottom = '35%'; teddyR.style.bottom = '35%';
            }, 1000);
        }, 1500);
    };

    // --- –°–¶–ï–ù–ê 2: –ú–ï–ß–ï–¢–ê–¢–ê ---
    const startGarden = () => {
        teddyL.style.opacity = '0'; teddyR.style.opacity = '0';
        bg.style.background = 'radial-gradient(circle, #4b0082, #1a0033, #000)';
        slowExplosion(window.innerWidth/2, window.innerHeight/2, '‚ú®', 40);

        setTimeout(() => {
            teddyL.style.display = 'none'; teddyR.style.display = 'none';
            instr.innerText = '–°—ä–±–µ—Ä–∏ 5 –≤—ä–ª—à–µ–±–Ω–∏ —Ä–æ–∑–∏ –∑–∞ –∫—ä—Å–º–µ—Ç...';
            garden.style.display = 'block';
            spawnTargetFlower();
        }, 2000);
    };

    teddyL.onclick = startGarden;
    teddyR.onclick = startGarden;

    // --- –°–¶–ï–ù–ê 3: –ì–†–ê–î–ò–ù–ê–¢–ê (–ú–ò–ù–ò –ò–ì–†–ê) ---
    function spawnTargetFlower() {
        if(flowerCount >= 5) {
            finishFilm();
            return;
        }
        const f = document.createElement('button');
        f.className = 'game-obj';
        f.innerHTML = 'üåπ';
        f.style.left = (20 + Math.random() * 60) + '%';
        f.style.top = (30 + Math.random() * 40) + '%';
        f.style.fontSize = '60px';
        garden.appendChild(f);
        
        setTimeout(() => f.style.transform = 'translate(-50%, -50%) scale(1.2)', 50);

        f.onclick = () => {
            flowerCount++;
            f.style.transform = 'translate(-50%, -50%) scale(0)';
            slowExplosion(parseInt(f.style.left), parseInt(f.style.top), 'üå∏', 10);
            setTimeout(() => {
                f.remove();
                spawnTargetFlower();
            }, 500);
        };
    }

    // --- –°–¶–ï–ù–ê 4: –§–ò–ù–ê–õ ---
    function finishFilm() {
        instr.style.opacity = '0';
        bg.style.background = 'radial-gradient(circle, #660033, #000)';
        
        setTimeout(() => {
            finalCont.style.display = 'block';
            setTimeout(() => {
                finalCont.style.transform = 'translate(-50%, -50%) scale(1.1)';
                startMagicRain();
            }, 500);
        }, 1500);
    }

    function slowExplosion(x, y, char, count) {
        for(let i=0; i<count; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.innerHTML = char;
            p.style.left = x + 'px'; p.style.top = y + 'px';
            p.style.fontSize = '20px';
            document.body.appendChild(p);
            const a = Math.random() * Math.PI * 2;
            const d = 50 + Math.random() * 150;
            p.animate([
                { transform: 'translate(0,0) scale(1)', opacity: 1 },
                { transform: `translate(${Math.cos(a)*d}px, ${Math.sin(a)*d}px) scale(0)`, opacity: 0 }
            ], { duration: 2500, easing: 'cubic-bezier(0.1, 0.8, 0.3, 1)' }).onfinish = () => p.remove();
        }
    }

    function startMagicRain() {
        setInterval(() => {
            const e = document.createElement('div');
            e.className = 'particle';
            e.innerHTML = ['‚ù§Ô∏è','üíñ','‚ú®','üåπ','üå∏'][Math.floor(Math.random()*5)];
            e.style.left = Math.random() * 100 + 'vw';
            e.style.top = '-50px';
            e.style.fontSize = (20 + Math.random() * 20) + 'px';
            e.style.filter = 'blur(' + (Math.random() * 2) + 'px)';
            document.body.appendChild(e);
            
            const dur = 4000 + Math.random() * 4000;
            e.animate([
                { transform: 'translateY(0) rotate(0deg)', opacity: 0 },
                { transform: 'translateY(20vh) rotate(45deg)', opacity: 1, offset: 0.2 },
                { transform: `translateY(110vh) rotate(${Math.random()*720}deg)`, opacity: 0 }
            ], { duration: dur, easing: 'linear' }).onfinish = () => e.remove();
        }, 150);
    }

    // –ü–æ—Å—Ç–æ—è–Ω–Ω–∏ –∏—Å–∫—Ä–∏ –ø—Ä–∏ –¥–æ–∫–æ—Å–≤–∞–Ω–µ
    document.addEventListener('touchstart', (e) => {
        const t = e.touches[0];
        slowExplosion(t.clientX, t.clientY, '‚ú®', 3);
    });
</script>
</body>
</html>
